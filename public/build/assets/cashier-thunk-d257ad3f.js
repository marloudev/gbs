import{a as g}from"./sales-service-19b3eac2.js";import{ar as e,h as p,o}from"./app-fd6d6e0e.js";async function f(t){return(await axios.get("/api/get_cart/"+t)).data.data}async function w(t){return(await axios.post("/api/carts",t)).data}async function y(t){return(await axios.put(`/api/carts/${t.id}`,t)).data.data}async function S(t){return(await axios.delete(`/api/carts/${t}`)).data.data}function C(){return async function(t,a){const n=localStorage.getItem("receipt_id"),s=await f(n);t(e.actions.setCart(s))}}function T(t){return async function(a,n){const s=await S(t);a(e.actions.setCart(s))}}function h(t){return async function(a,n){const s=await y(t);a(e.actions.setCart(s))}}function v(t){return async function(a,n){var s,r,i,c,u,d,_;if((await t).status=="success"){localStorage.getItem("receipt_id")||localStorage.setItem("receipt_id",p().format("MMDDYYYYHHmmss"));const m=Math.floor(1e9+Math.random()*9e9),l=await w({receipt_id:localStorage.getItem("receipt_id"),barcode:(await t).data.barcode,randomId:m,quantity:((r=(s=await t)==null?void 0:s.data)==null?void 0:r.quantity)??1,price:(await t).data.price,total:(await t).data.price,capital:((c=(i=await t)==null?void 0:i.data)==null?void 0:c.capital)??0,supply_barcode:((_=(d=(u=(await t).data)==null?void 0:u.item_product)==null?void 0:d.item)==null?void 0:_.barcode)??0});a(e.actions.setCart(l.data)),a(e.actions.setSearch(""))}else a(e.actions.setSearch(""))}}function x(){return async function(t,a){t(e.actions.setLoading(!0)),t(o.actions.setToastStatus({status:"loading",message:"Loading..."}));const n=a().cashier.payment,s=a().cashier.cart,r={payment:n,cart:s};try{await g(r),await t(e.actions.setIsPrint(!0)),setTimeout(()=>{t(e.actions.setIsPrint(!1))},1e3),await t(e.actions.setLoading(!1)),await t(e.actions.resetPayment()),await t(o.actions.setToastStatus({status:"success",message:"Created Success!"})),localStorage.clear()}catch(i){t(e.actions.setLoading(!1)),t(o.actions.setToastStatus({status:"error",message:i.response.data.message}))}}}export{v as a,x as c,T as d,h as e,C as g};
